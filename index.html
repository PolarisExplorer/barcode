<!DOCTYPE html>
<html lang="sr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pretraga Artikala</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel">
        const { useState, useEffect } = React;
       
        function BarcodeChecker() {
          const [artikli, setArtikli] = useState([]);
          const [searchTerm, setSearchTerm] = useState('');
          const [results, setResults] = useState([]);
          const [loading, setLoading] = useState(true);
          const [error, setError] = useState(null);

          useEffect(() => {
            loadExcelFile();
          }, []);

          const loadExcelFile = async () => {
            try {
              setLoading(true);
              setError(null);
             
              const response = await fetch('artikli.xlsx');
             
              if (!response.ok) {
                throw new Error('Excel fajl nije pronaƒëen. Provjerite da li se artikli.xlsx nalazi u istom folderu.');
              }
             
              const arrayBuffer = await response.arrayBuffer();
              const workbook = XLSX.read(arrayBuffer, { type: 'array' });
             
              const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
              const data = XLSX.utils.sheet_to_json(firstSheet);
             
              setArtikli(data);
              setLoading(false);
            } catch (err) {
              setError(err.message);
              setLoading(false);
            }
          };

          const handleSearch = (value) => {
            // Dozvoljavamo samo brojeve (uklanjamo sve ≈°to nije cifra)
            const numericValue = value.replace(/[^0-9]/g, '');
            setSearchTerm(numericValue);
           
            if (numericValue.trim() === '') {
              setResults([]);
              return;
            }

            const searchValue = numericValue.toLowerCase();
            const foundItems = artikli.filter(item => {
              return Object.values(item).some(val =>
                val && val.toString().toLowerCase().includes(searchValue)
              );
            });
            setResults(foundItems);
          };

          if (loading) {
            return React.createElement('div', { className: "min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4" },
              React.createElement('div', { className: "bg-white rounded-lg shadow-xl p-8 text-center" },
                React.createElement('div', { className: "animate-spin rounded-full h-16 w-16 border-b-4 border-indigo-600 mx-auto mb-4" }),
                React.createElement('p', { className: "text-gray-700 text-lg" }, 'Uƒçitavam artikle...')
              )
            );
          }

          if (error) {
            return React.createElement('div', { className: "min-h-screen bg-gradient-to-br from-red-50 to-orange-100 flex items-center justify-center p-4" },
              React.createElement('div', { className: "bg-white rounded-lg shadow-xl p-8 max-w-md" },
                React.createElement('div', { className: "text-center" },
                  React.createElement('p', { className: "text-6xl mb-4" }, '‚ö†Ô∏è'),
                  React.createElement('h2', { className: "text-2xl font-bold text-gray-800 mb-4" }, 'Gre≈°ka'),
                  React.createElement('p', { className: "text-gray-600 mb-6" }, error),
                  React.createElement('button', {
                    onClick: loadExcelFile,
                    className: "w-full bg-indigo-600 text-white py-3 rounded-lg hover:bg-indigo-700 transition"
                  }, 'Poku≈°aj Ponovo')
                )
              )
            );
          }

          return React.createElement('div', { className: "min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-4" },
            React.createElement('div', { className: "max-w-4xl mx-auto py-8" },
              React.createElement('div', { className: "bg-white rounded-lg shadow-xl p-6 mb-6" },
                React.createElement('div', { className: "flex items-center gap-3 mb-2" },
                  React.createElement('span', { className: "text-4xl" }, 'üì¶'),
                  React.createElement('h1', { className: "text-3xl font-bold text-gray-800" }, 'Pretraga Artikala')
                ),
                React.createElement('p', { className: "text-gray-600" },
                  'Ukupno artikala u bazi: ',
                  React.createElement('span', { className: "font-semibold text-indigo-600" }, artikli.length)
                )
              ),
             
              React.createElement('div', { className: "bg-white rounded-lg shadow-xl p-6 mb-6" },
                React.createElement('div', { className: "relative" },
                  React.createElement('span', {
                    className: "absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400 text-xl"
                  }, 'üîç'),
                  React.createElement('input', {
                    type: "text",                    // ostaje "text" jer "number" ima lo≈°e pona≈°anje kod barkodova
                    inputMode: "numeric",            // ‚Üê OVO otvara numeriƒçku tastaturu na mobilnim
                    pattern: "[0-9]*",               // ‚Üê dodatno poma≈æe iOS-u da poka≈æe brojƒçanu tastaturu
                    value: searchTerm,
                    onChange: (e) => handleSearch(e.target.value),
                    placeholder: 'Unesite barkod...',
                    className: "w-full pl-12 pr-4 py-4 text-lg border-2 border-gray-200 rounded-lg focus:border-indigo-500 focus:outline-none transition",
                    autoFocus: true
                  })
                )
              ),
             
              searchTerm && React.createElement('div', { className: "bg-white rounded-lg shadow-xl p-6" },
                results.length > 0 ? [
                  React.createElement('div', { key: 'header', className: "flex items-center gap-2 mb-4" },
                    React.createElement('span', { className: "text-2xl" }, '‚úÖ'),
                    React.createElement('h2', { className: "text-xl font-semibold text-gray-800" },
                      `Pronaƒëeno ${results.length} ${results.length === 1 ? 'artikal' : 'artikala'}`
                    )
                  ),
                  React.createElement('div', { key: 'results', className: "space-y-4" },
                    results.map((item, index) =>
                      React.createElement('div', {
                        key: index,
                        className: "border-2 border-green-200 bg-green-50 rounded-lg p-4"
                      },
                        Object.entries(item).map(([key, value]) =>
                          React.createElement('div', { key: key, className: "flex py-1" },
                            React.createElement('span', { className: "font-semibold text-gray-700 min-w-[150px]" }, key + ':'),
                            React.createElement('span', { className: "text-gray-900" }, value)
                          )
                        )
                      )
                    )
                  )
                ] : React.createElement('div', { className: "text-center py-8" },
                  React.createElement('span', { className: "text-6xl block mb-4" }, '‚ùå'),
                  React.createElement('h2', { className: "text-2xl font-semibold text-gray-800 mb-2" }, 'Artikal nije pronaƒëen'),
                  React.createElement('p', { className: "text-gray-600" },
                    'Nema artikala koji odgovaraju barkodu: ',
                    React.createElement('span', { className: "font-semibold" }, `"${searchTerm}"`)
                  )
                )
              ),
             
              !searchTerm && React.createElement('div', { className: "bg-white rounded-lg shadow-xl p-6" },
                React.createElement('h3', { className: "text-lg font-semibold text-gray-800 mb-3" }, 'Uputstvo:'),
                React.createElement('ul', { className: "space-y-2 text-gray-600" },
                  React.createElement('li', { className: "flex items-start gap-2" },
                    React.createElement('span', { className: "text-indigo-600 font-bold" }, '1.'),
                    React.createElement('span', null, 'Unesite barkod skenerom ili ruƒçno (samo brojevi)')
                  ),
                  React.createElement('li', { className: "flex items-start gap-2" },
                    React.createElement('span', { className: "text-indigo-600 font-bold" }, '2.'),
                    React.createElement('span', null, 'Na telefonu ƒáe se automatski otvoriti numeriƒçka tastatura')
                  ),
                  React.createElement('li', { className: "flex items-start gap-2" },
                    React.createElement('span', { className: "text-indigo-600 font-bold" }, '3.'),
                    React.createElement('span', null, 'Pretraga radi u realnom vremenu')
                  ),
                  React.createElement('li', { className: "flex items-start gap-2" },
                    React.createElement('span', { className: "text-indigo-600 font-bold" }, '4.'),
                    React.createElement('span', null, 'Za novu bazu zamijenite artikli.xlsx i osvje≈æite stranicu')
                  )
                )
              )
            )
          );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(React.createElement(BarcodeChecker));
    </script>
</body>
</html>